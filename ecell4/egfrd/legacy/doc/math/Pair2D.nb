(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    157458,       4914]
NotebookOptionsPosition[    151602,       4717]
NotebookOutlinePosition[    152159,       4737]
CellTagsIndexPosition[    152116,       4734]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Define", " ", "functions"}], "*)"}]], "Input",
 CellChangeTimes->{{3.464996520987191*^9, 3.4649965322393007`*^9}, {
  3.4649965625973997`*^9, 3.464996635351671*^9}, {3.46500914340935*^9, 
  3.46500914677929*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"urr0", "[", 
   RowBox[{"n_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "Pi", " ", "k"}], ")"}]}], " ", "e", " ", 
   RowBox[{"BesselK", "[", 
    RowBox[{"n", ",", 
     RowBox[{"q", " ", "r0"}]}], "]"}], " ", 
   RowBox[{"BesselI", "[", 
    RowBox[{"n", ",", 
     RowBox[{"q", " ", "r"}]}], "]"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ur0r", "[", 
   RowBox[{"n_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "Pi", " ", "k"}], ")"}]}], " ", "e", " ", 
   RowBox[{"BesselK", "[", 
    RowBox[{"n", ",", 
     RowBox[{"q", " ", "r"}]}], "]"}], " ", 
   RowBox[{"BesselI", "[", 
    RowBox[{"n", ",", 
     RowBox[{"q", " ", "r0"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.464996644305251*^9, 3.464996669389474*^9}, {
  3.464996789649354*^9, 3.464996792949348*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"spell1\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"\:30b9\:30da\:30eb\:9593\
\:9055\:3044\:306e\:53ef\:80fd\:6027\:304c\:3042\:308a\:307e\:3059\:ff0e\:65b0\
\:898f\:30b7\:30f3\:30dc\:30eb\\\\\\\\\\\\\\\"\\\\\\\"\\\", \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\!\\(ur0r\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\"\\\\\\\\\\\\\\\"\:306f\
\:3059\:3067\:306b\:3042\:308b\:30b7\:30f3\:30dc\:30eb\\\\\\\\\\\\\\\"\\\\\\\"\
\\\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(urr0\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\"\\\\\\\\\\\\\\\"\:306b\:4f3c\:3066\
\:3044\:307e\:3059\:ff0e\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/spell1\\\", ButtonNote -> \
\\\"General::spell1\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4650284519954567`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"wi", "[", 
   RowBox[{"n_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "Pi", " ", "k"}], ")"}]}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"An", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
     RowBox[{"Bn", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "r"}]}], "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.4649968036992607`*^9, 3.464996841299477*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bess", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"BesselI", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ",", "z_"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"BesselI", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", "z"}], "]"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"n", "/", "z"}], " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}]}]}], ",", 
    RowBox[{
     RowBox[{"BesselK", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ",", "z_"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"BesselK", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", "z"}], "]"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"n", "/", "z"}], " ", 
       RowBox[{"BesselK", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}]}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.46502869963933*^9, 3.4650287069902687`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"BesselI", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ",", "z_"}], "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "n", " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], "z"], "+", 
     RowBox[{"BesselI", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", "z"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"BesselK", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ",", "z_"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "n", " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", "z"}], "]"}]}], "z"]}], "+", 
     RowBox[{"BesselK", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", "z"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.465028736101714*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"der", "[", "s_", "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"wi", "[", 
        RowBox[{"n", ",", "s"}], "]"}], "+", 
       RowBox[{"urr0", "[", 
        RowBox[{"n", ",", "s"}], "]"}]}], ",", "s"}], "]"}], "/.", "bess"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4650273394292383`*^9, 3.465027340489285*^9}, {
  3.465027616058898*^9, 3.465027735079214*^9}, {3.4650278758068953`*^9, 
  3.465027912149527*^9}, {3.465028295309252*^9, 3.4650282964830103`*^9}, {
  3.465028715389406*^9, 3.4650287178936663`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "k", " ", "\[Pi]", " ", "s"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"n", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"n", ",", 
       RowBox[{"q", " ", "s"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"An", "+", 
       RowBox[{"e", " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "r0"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{"q", " ", "s", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"q", " ", "s"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"An", "+", 
       RowBox[{"e", " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "r0"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{"Bn", " ", "n", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"n", ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
    RowBox[{"Bn", " ", "q", " ", "s", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.465027627363399*^9, 3.4650277385075817`*^9, {3.465027887872402*^9, 
   3.465027912946643*^9}, 3.4650282987751627`*^9, 3.465028459601646*^9, {
   3.465028729967141*^9, 3.465028742436324*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "solution", "}"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"der", "[", "s", "]"}], "\[Equal]", 
        RowBox[{"h", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"wi", "[", 
            RowBox[{"n", ",", "s"}], "]"}], "+", 
           RowBox[{"urr0", "[", 
            RowBox[{"n", ",", "s"}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"wi", "[", 
          RowBox[{"n", ",", "a"}], "]"}], "+", 
         RowBox[{"ur0r", "[", 
          RowBox[{"n", ",", "a"}], "]"}]}], "==", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"An", ",", "Bn"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.46499696421952*^9, 3.464997037572978*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"An", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"e", " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "q"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"BesselI", "[", 
             RowBox[{"n", ",", 
              RowBox[{"q", " ", "s"}]}], "]"}], " ", 
            RowBox[{"BesselK", "[", 
             RowBox[{"n", ",", 
              RowBox[{"q", " ", "r0"}]}], "]"}]}], "+", 
           RowBox[{"q", " ", "s", " ", 
            RowBox[{"BesselI", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"q", " ", "s"}]}], "]"}], " ", 
            RowBox[{"BesselK", "[", 
             RowBox[{"n", ",", 
              RowBox[{"q", " ", "r0"}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"BesselI", "[", 
             RowBox[{"n", ",", 
              RowBox[{"q", " ", "r0"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "n"}], "+", 
                 RowBox[{"h", " ", "s"}]}], ")"}], " ", 
               RowBox[{"BesselK", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
              RowBox[{"q", " ", "s", " ", 
               RowBox[{"BesselK", "[", 
                RowBox[{
                 RowBox[{"1", "+", "n"}], ",", 
                 RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselI", "[", 
           RowBox[{"n", ",", 
            RowBox[{"q", " ", "s"}]}], "]"}], " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
         RowBox[{"q", " ", "s", " ", 
          RowBox[{"BesselI", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"q", " ", "s"}]}], "]"}], " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"BesselI", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "q"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "n"}], "+", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselK", "[", 
              RowBox[{"n", ",", 
               RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
            RowBox[{"q", " ", "s", " ", 
             RowBox[{"BesselK", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}]}], 
    ",", 
    RowBox[{"Bn", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"e", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"BesselI", "[", 
             RowBox[{"n", ",", 
              RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
           RowBox[{"q", " ", "s", " ", 
            RowBox[{"BesselI", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"BesselI", "[", 
             RowBox[{"n", ",", 
              RowBox[{"q", " ", "r0"}]}], "]"}], " ", 
            RowBox[{"BesselK", "[", 
             RowBox[{"n", ",", 
              RowBox[{"a", " ", "q"}]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"BesselI", "[", 
             RowBox[{"n", ",", 
              RowBox[{"a", " ", "q"}]}], "]"}], " ", 
            RowBox[{"BesselK", "[", 
             RowBox[{"n", ",", 
              RowBox[{"q", " ", "r0"}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselI", "[", 
           RowBox[{"n", ",", 
            RowBox[{"q", " ", "s"}]}], "]"}], " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
         RowBox[{"q", " ", "s", " ", 
          RowBox[{"BesselI", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"q", " ", "s"}]}], "]"}], " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"BesselI", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "q"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "n"}], "+", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselK", "[", 
              RowBox[{"n", ",", 
               RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
            RowBox[{"q", " ", "s", " ", 
             RowBox[{"BesselK", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}]}]}],
    "}"}], "}"}]], "Output",
 CellChangeTimes->{3.465028397984737*^9, 3.465028473367322*^9, 
  3.465028769108425*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"The", " ", "solution", " ", "is"}], ",", " ", 
   RowBox[{"at", " ", "fixed", " ", "n"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.465003732609207*^9, 3.465003746839182*^9}, {
  3.465009150429286*^9, 3.4650091531792088`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solutionn", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"wi", "[", 
      RowBox[{"n", ",", "r"}], "]"}], "/.", "solution"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ">", "0"}], "}"}], "&&", 
     RowBox[{"{", 
      RowBox[{"a", ">", "0"}], "}"}], "&&", 
     RowBox[{"{", 
      RowBox[{"r0", ">", "0"}], "}"}], "&&", 
     RowBox[{"{", 
      RowBox[{"n", "\[Element]", "Integers"}], "}"}], "&&", 
     RowBox[{"{", 
      RowBox[{"n", "\[GreaterEqual]", "0"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.465003765809223*^9, 3.465003847119248*^9}, {
  3.465011080569249*^9, 3.465011104759265*^9}, {3.465011162291977*^9, 
  3.465011174249423*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"e", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselI", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
          RowBox[{"q", " ", "s", " ", 
           RowBox[{"BesselI", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"BesselI", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "r"}]}], "]"}], " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{"n", ",", 
             RowBox[{"a", " ", "q"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"BesselI", "[", 
            RowBox[{"n", ",", 
             RowBox[{"a", " ", "q"}]}], "]"}], " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "r"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "r0"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"BesselI", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "r0"}]}], "]"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "q"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselI", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "s"}]}], "]"}], " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
          RowBox[{"q", " ", "s", " ", 
           RowBox[{"BesselI", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"q", " ", "s"}]}], "]"}], " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"BesselI", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "r"}]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "n"}], "+", 
                RowBox[{"h", " ", "s"}]}], ")"}], " ", 
              RowBox[{"BesselK", "[", 
               RowBox[{"n", ",", 
                RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
             RowBox[{"q", " ", "s", " ", 
              RowBox[{"BesselK", "[", 
               RowBox[{
                RowBox[{"1", "+", "n"}], ",", 
                RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"2", " ", "k", " ", "\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselI", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "s"}]}], "]"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
       RowBox[{"q", " ", "s", " ", 
        RowBox[{"BesselI", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"q", " ", "s"}]}], "]"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"BesselI", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "q"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "n"}], "+", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
          RowBox[{"q", " ", "s", " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.46500382139851*^9, 3.4650038814411097`*^9, 
  3.4650093756336412`*^9, 3.46501121407939*^9, 3.465027800196801*^9, 
  3.465027964914584*^9, 3.46502830438936*^9, 3.465028503292445*^9, 
  3.465028772992305*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "solution", " ", "has", " ", "poles", " ", "at", " ", "the", 
   " ", "zeros", " ", "of"}], "*)"}]], "Input",
 CellChangeTimes->{{3.465003927869266*^9, 3.465003936161063*^9}, {
  3.465009157149685*^9, 3.4650091590191936`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"equationk", " ", "=", " ", 
  RowBox[{"Simplify", "[", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"h", " ", "s"}]}], ")"}], " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "s"}]}], "]"}], " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"n", ",", 
        RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
     RowBox[{"q", " ", "s", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", 
        RowBox[{"q", " ", "s"}]}], "]"}], " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"n", ",", 
        RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"BesselI", "[", 
       RowBox[{"n", ",", 
        RowBox[{"a", " ", "q"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"h", " ", "s"}]}], ")"}], " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{"n", ",", 
           RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
        RowBox[{"q", " ", "s", " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4650039383492327`*^9, 3.4650039806631107`*^9}, {
  3.465027977259346*^9, 3.4650279953698893`*^9}, {3.465028514469204*^9, 
  3.4650285357996073`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"n", "-", 
     RowBox[{"h", " ", "s"}]}], ")"}], " ", 
   RowBox[{"BesselI", "[", 
    RowBox[{"n", ",", 
     RowBox[{"q", " ", "s"}]}], "]"}], " ", 
   RowBox[{"BesselK", "[", 
    RowBox[{"n", ",", 
     RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
  RowBox[{"q", " ", "s", " ", 
   RowBox[{"BesselI", "[", 
    RowBox[{
     RowBox[{"1", "+", "n"}], ",", 
     RowBox[{"q", " ", "s"}]}], "]"}], " ", 
   RowBox[{"BesselK", "[", 
    RowBox[{"n", ",", 
     RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"BesselI", "[", 
    RowBox[{"n", ",", 
     RowBox[{"a", " ", "q"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "n"}], "+", 
        RowBox[{"h", " ", "s"}]}], ")"}], " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
     RowBox[{"q", " ", "s", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", 
        RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.465003975425762*^9, 3.465009376777582*^9, {3.4650279788718452`*^9, 
   3.465027996536384*^9}, {3.4650285161414423`*^9, 3.465028536901491*^9}, 
   3.4650287766923933`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmpnum", "=", 
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", 
           RowBox[{"h", " ", "s"}]}], ")"}], " ", 
         RowBox[{"BesselI", "[", 
          RowBox[{"n", ",", 
           RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
        RowBox[{"q", " ", "s", " ", 
         RowBox[{"BesselI", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"BesselI", "[", 
          RowBox[{"n", ",", 
           RowBox[{"q", " ", "r"}]}], "]"}], " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "q"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"BesselI", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "q"}]}], "]"}], " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{"n", ",", 
           RowBox[{"q", " ", "r"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "r0"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"BesselI", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "r0"}]}], "]"}], " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"n", ",", 
        RowBox[{"a", " ", "q"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", 
           RowBox[{"h", " ", "s"}]}], ")"}], " ", 
         RowBox[{"BesselI", "[", 
          RowBox[{"n", ",", 
           RowBox[{"q", " ", "s"}]}], "]"}], " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{"n", ",", 
           RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
        RowBox[{"q", " ", "s", " ", 
         RowBox[{"BesselI", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"q", " ", "s"}]}], "]"}], " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{"n", ",", 
           RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"BesselI", "[", 
          RowBox[{"n", ",", 
           RowBox[{"q", " ", "r"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "n"}], "+", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"BesselK", "[", 
             RowBox[{"n", ",", 
              RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
           RowBox[{"q", " ", "s", " ", 
            RowBox[{"BesselK", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.465008989696829*^9, 3.465009054529223*^9}, {
  3.465009174913804*^9, 3.465009184609563*^9}, {3.465009244731144*^9, 
  3.465009246299309*^9}, {3.465010915209323*^9, 3.465010931549279*^9}, {
  3.465012121668621*^9, 3.465012123799354*^9}, {3.465028024332992*^9, 
  3.465028049609239*^9}, {3.465028568893333*^9, 3.4650285763492613`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
      RowBox[{"q", " ", "s", " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"BesselI", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "r"}]}], "]"}], " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"n", ",", 
        RowBox[{"a", " ", "q"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"BesselI", "[", 
       RowBox[{"n", ",", 
        RowBox[{"a", " ", "q"}]}], "]"}], " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "r"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"BesselK", "[", 
    RowBox[{"n", ",", 
     RowBox[{"q", " ", "r0"}]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"BesselI", "[", 
    RowBox[{"n", ",", 
     RowBox[{"q", " ", "r0"}]}], "]"}], " ", 
   RowBox[{"BesselK", "[", 
    RowBox[{"n", ",", 
     RowBox[{"a", " ", "q"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"h", " ", "s"}]}], ")"}], " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "s"}]}], "]"}], " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
     RowBox[{"q", " ", "s", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", 
        RowBox[{"q", " ", "s"}]}], "]"}], " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"BesselI", "[", 
       RowBox[{"n", ",", 
        RowBox[{"q", " ", "r"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"h", " ", "s"}]}], ")"}], " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{"n", ",", 
           RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
        RowBox[{"q", " ", "s", " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.465028050652946*^9, 3.465028577685164*^9, 
  3.465028780953032*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solute", "=", 
  RowBox[{"e", " ", 
   RowBox[{"tmpnum", "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "k", " ", "Pi", " ", "equationk"}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.465004052709672*^9, 3.4650040812191973`*^9}, {
  3.465028060495475*^9, 3.4650280826713963`*^9}, {3.4650281586492043`*^9, 
  3.465028212762974*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"e", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselI", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
          RowBox[{"q", " ", "s", " ", 
           RowBox[{"BesselI", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"BesselI", "[", 
           RowBox[{"n", ",", 
            RowBox[{"q", " ", "r"}]}], "]"}], " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "q"}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"BesselI", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "q"}]}], "]"}], " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{"n", ",", 
            RowBox[{"q", " ", "r"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{"BesselK", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "r0"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"BesselI", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "r0"}]}], "]"}], " ", 
       RowBox[{"BesselK", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "q"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselI", "[", 
           RowBox[{"n", ",", 
            RowBox[{"q", " ", "s"}]}], "]"}], " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{"n", ",", 
            RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
         RowBox[{"q", " ", "s", " ", 
          RowBox[{"BesselI", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"q", " ", "s"}]}], "]"}], " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{"n", ",", 
            RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"BesselI", "[", 
           RowBox[{"n", ",", 
            RowBox[{"q", " ", "r"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "n"}], "+", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselK", "[", 
              RowBox[{"n", ",", 
               RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
            RowBox[{"q", " ", "s", " ", 
             RowBox[{"BesselK", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"2", " ", "k", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "s"}]}], "]"}], " ", 
       RowBox[{"BesselK", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
      RowBox[{"q", " ", "s", " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"q", " ", "s"}]}], "]"}], " ", 
       RowBox[{"BesselK", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"BesselI", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "q"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "n"}], "+", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{"n", ",", 
            RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
         RowBox[{"q", " ", "s", " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.465028064407044*^9, 3.4650280787571*^9}, {
   3.465028155697752*^9, 3.465028213677059*^9}, 3.465028586657688*^9, 
   3.465028783586874*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"solute", "-", "solutionn"}], "]"}]], "Input",
 CellChangeTimes->{{3.465028592231159*^9, 3.46502859834061*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.4650285993005238`*^9, 3.4650287864013147`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "solun", "}"}], "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"equationk", "\[Equal]", "0"}], ",", 
    RowBox[{"BesselI", "[", 
     RowBox[{"n", ",", 
      RowBox[{"a", " ", "q"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4650041604492893`*^9, 3.465004178771497*^9}, {
  3.4650062356693773`*^9, 3.465006242369338*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"BesselI", "[", 
     RowBox[{"n", ",", 
      RowBox[{"a", " ", "q"}]}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", 
        RowBox[{"BesselI", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "s"}]}], "]"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "q"}]}], "]"}]}], "-", 
       RowBox[{"h", " ", "s", " ", 
        RowBox[{"BesselI", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "s"}]}], "]"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
       RowBox[{"q", " ", "s", " ", 
        RowBox[{"BesselI", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"q", " ", "s"}]}], "]"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "q"}]}], "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
       RowBox[{"h", " ", "s", " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
       RowBox[{"q", " ", "s", " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.465004180231718*^9, 3.465006243382094*^9, 
  3.4650093795366783`*^9, 3.465028234241942*^9, 3.4650286044154243`*^9, 
  3.4650287971533623`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "The", " ", "residues", " ", "for", " ", "this", " ", "integration", " ", 
   "are"}], "*)"}]], "Input",
 CellChangeTimes->{{3.465004266780231*^9, 3.4650042723792133`*^9}, {
  3.465009419569323*^9, 3.465009422049334*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numerator", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Together", "[", 
    RowBox[{"tmpnum", "/.", "solun"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.465012245209152*^9, 3.465012258759203*^9}, {
  3.465012320279203*^9, 3.465012392512993*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"BesselK", "[", 
     RowBox[{"n", ",", 
      RowBox[{"a", " ", "q"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "s"}]}], "]"}], " ", 
       RowBox[{"BesselK", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
      RowBox[{"q", " ", "s", " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"q", " ", "s"}]}], "]"}], " ", 
       RowBox[{"BesselK", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"BesselI", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "r"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "n"}], "+", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{"n", ",", 
            RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
         RowBox[{"q", " ", "s", " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "s"}]}], "]"}], " ", 
       RowBox[{"BesselK", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "r0"}]}], "]"}]}], "+", 
      RowBox[{"q", " ", "s", " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"q", " ", "s"}]}], "]"}], " ", 
       RowBox[{"BesselK", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "r0"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"BesselI", "[", 
        RowBox[{"n", ",", 
         RowBox[{"q", " ", "r0"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "n"}], "+", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{"n", ",", 
            RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
         RowBox[{"q", " ", "s", " ", 
          RowBox[{"BesselK", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", 
       RowBox[{"h", " ", "s"}]}], ")"}], " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"n", ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
    RowBox[{"q", " ", "s", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.4650122507182837`*^9, 3.465012260093822*^9}, {
   3.4650123398774233`*^9, 3.465012361075692*^9}, 3.465012393305582*^9, 
   3.465028247870327*^9, 3.46502861734231*^9, 3.4650288034027653`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dequationk", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"equationk", ",", "q"}], "]"}], "]"}], "/.", "bess"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4650041953992653`*^9, 3.465004201239246*^9}, {
  3.4650061477727423`*^9, 3.465006159099184*^9}, {3.46502882249936*^9, 
  3.4650288508032007`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "q"], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["n", "2"], " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "q"}]}], "]"}], " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"n", ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", "h", " ", "n", " ", "s", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "q"}]}], "]"}], " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"n", ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q", "2"], " ", 
     SuperscriptBox["s", "2"], " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "q"}]}], "]"}], " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"n", ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
    RowBox[{"a", " ", "n", " ", "q", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"a", " ", "q"}]}], "]"}], " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"n", ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
    RowBox[{"a", " ", "h", " ", "q", " ", "s", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"a", " ", "q"}]}], "]"}], " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"n", ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
    RowBox[{"q", " ", "s", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"q", " ", "s"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
       RowBox[{"a", " ", "q", " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"a", " ", "q"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"BesselI", "[", 
      RowBox[{"n", ",", 
       RowBox[{"q", " ", "s"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"2", " ", "h", " ", "n", " ", "s"}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           SuperscriptBox["s", "2"]}]}], ")"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
       RowBox[{"a", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"a", " ", "q"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{"n", " ", "q", " ", "s", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "q"}]}], "]"}], " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
    RowBox[{"h", " ", "q", " ", 
     SuperscriptBox["s", "2"], " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "q"}]}], "]"}], " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
    RowBox[{"a", " ", 
     SuperscriptBox["q", "2"], " ", "s", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"a", " ", "q"}]}], "]"}], " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.465006160685314*^9, 3.465009389744376*^9, 3.465028670633984*^9, {
   3.465028811860956*^9, 3.465028852317011*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"denominator", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "q", " ", "k"}], ")"}]}], " ", "Dequationk"}], "/.", 
    "solun"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.465006170619351*^9, 3.465006283559177*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"spell1\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"\:30b9\:30da\:30eb\:9593\
\:9055\:3044\:306e\:53ef\:80fd\:6027\:304c\:3042\:308a\:307e\:3059\:ff0e\:65b0\
\:898f\:30b7\:30f3\:30dc\:30eb\\\\\\\\\\\\\\\"\\\\\\\"\\\", \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\!\\(denominator\\), \\\"MT\\\"]\\)\[NoBreak]\\!\
\\(\\*StyleBox[\\\"\\\\\\\"\\\\\\\\\\\\\\\"\:306f\:3059\:3067\:306b\:3042\
\:308b\:30b7\:30f3\:30dc\:30eb\\\\\\\\\\\\\\\"\\\\\\\"\\\", \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Denominator\\), \\\"MT\\\"]\\)\[NoBreak]\\!\
\\(\\*StyleBox[\\\"\\\\\\\"\\\\\\\\\\\\\\\"\:306b\:4f3c\:3066\:3044\:307e\
\:3059\:ff0e\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/spell1\\\", ButtonNote -> \
\\\"General::spell1\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.465028873948928*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["n", "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["h", "2"]}], "+", 
             SuperscriptBox["q", "2"]}], ")"}], " ", 
           SuperscriptBox["s", "2"]}]}], ")"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "q"}]}], "]"}]}], "q"]}], "-", 
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", 
           RowBox[{"h", " ", "s"}]}], ")"}], " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{"n", ",", 
           RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
        RowBox[{"q", " ", "s", " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"BesselI", "[", 
             RowBox[{"n", ",", 
              RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
           RowBox[{"q", " ", "s", " ", 
            RowBox[{"BesselI", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"BesselI", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"a", " ", "q"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"BesselK", "[", 
             RowBox[{"n", ",", 
              RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
           RowBox[{"q", " ", "s", " ", 
            RowBox[{"BesselK", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"2", " ", "k", " ", "q", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
       RowBox[{"q", " ", "s", " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{{3.465006264355875*^9, 3.4650062857946367`*^9}, 
   3.465009432971335*^9, 3.46502892129241*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prefn", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"e", " ", 
    RowBox[{"numerator", "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "k", " ", "Pi", " ", "denominator"}], ")"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.465006301699548*^9, 3.46500636256952*^9}, {
  3.465006549583947*^9, 3.4650065589693613`*^9}, {3.465006615729261*^9, 
  3.465006618089349*^9}, {3.465009476919691*^9, 3.4650094904612207`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"e", " ", 
     SuperscriptBox["q", "2"], " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "q"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselI", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "s"}]}], "]"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
       RowBox[{"q", " ", "s", " ", 
        RowBox[{"BesselI", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"q", " ", "s"}]}], "]"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "r"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"BesselI", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "r"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "n"}], "+", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
          RowBox[{"q", " ", "s", " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselI", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "s"}]}], "]"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "r0"}]}], "]"}]}], "+", 
       RowBox[{"q", " ", "s", " ", 
        RowBox[{"BesselI", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"q", " ", "s"}]}], "]"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "r0"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"BesselI", "[", 
         RowBox[{"n", ",", 
          RowBox[{"q", " ", "r0"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "n"}], "+", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
          RowBox[{"q", " ", "s", " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
   "/", 
   RowBox[{"(", 
    RowBox[{"\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["n", "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["h", "2"]}], "+", 
             SuperscriptBox["q", "2"]}], ")"}], " ", 
           SuperscriptBox["s", "2"]}]}], ")"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
       RowBox[{"a", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{"n", ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
          RowBox[{"q", " ", "s", " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", 
                RowBox[{"h", " ", "s"}]}], ")"}], " ", 
              RowBox[{"BesselI", "[", 
               RowBox[{"n", ",", 
                RowBox[{"q", " ", "s"}]}], "]"}]}], "+", 
             RowBox[{"q", " ", "s", " ", 
              RowBox[{"BesselI", "[", 
               RowBox[{
                RowBox[{"1", "+", "n"}], ",", 
                RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"BesselK", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"a", " ", "q"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"BesselI", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"a", " ", "q"}]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", 
                RowBox[{"h", " ", "s"}]}], ")"}], " ", 
              RowBox[{"BesselK", "[", 
               RowBox[{"n", ",", 
                RowBox[{"q", " ", "s"}]}], "]"}]}], "-", 
             RowBox[{"q", " ", "s", " ", 
              RowBox[{"BesselK", "[", 
               RowBox[{
                RowBox[{"1", "+", "n"}], ",", 
                RowBox[{"q", " ", "s"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.465006363859769*^9, 3.4650065529299793`*^9, {3.46500660247094*^9, 
   3.4650066189000807`*^9}, 3.4650093009001923`*^9, 3.465009433916567*^9, {
   3.4650094792949266`*^9, 3.46500949119223*^9}, 3.4650101741286697`*^9, 
   3.465012413150815*^9, 3.465012470221596*^9, 3.465028969458783*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trans", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"BesselK", "[", 
      RowBox[{"n_", ",", 
       RowBox[{"q", " ", "x_"}]}], "]"}], "->", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", "Pi", "  ", "I", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "Pi"}], " ", 
        RowBox[{
         RowBox[{"(", "n", ")"}], "/", "2"}], " ", "I"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"u", " ", "x"}]}], "]"}]}], "+", 
        RowBox[{"I", " ", 
         RowBox[{"BesselY", "[", 
          RowBox[{"n", ",", 
           RowBox[{"u", " ", "x"}]}], "]"}]}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"BesselI", "[", 
      RowBox[{"n_", ",", 
       RowBox[{"q", " ", "x_"}]}], "]"}], "->", 
     RowBox[{
      RowBox[{"Exp", "[", " ", 
       RowBox[{"Pi", " ", 
        RowBox[{
         RowBox[{"(", "n", ")"}], "/", "2"}], " ", "I"}], "]"}], 
      RowBox[{"BesselJ", "[", 
       RowBox[{"n", ",", 
        RowBox[{"u", " ", "x"}]}], "]"}]}]}], ",", 
    RowBox[{"q", "\[Rule]", 
     RowBox[{"I", " ", "u"}]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"BesselK", "[", 
     RowBox[{"n_", ",", 
      RowBox[{"q", " ", "x_"}]}], "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", "n", " ", 
       "\[Pi]"}]], " ", "\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"u", " ", "x"}]}], "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"BesselY", "[", 
         RowBox[{"n", ",", 
          RowBox[{"u", " ", "x"}]}], "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"BesselI", "[", 
     RowBox[{"n_", ",", 
      RowBox[{"q", " ", "x_"}]}], "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Pi]"}], "2"]], " ", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"n", ",", 
       RowBox[{"u", " ", "x"}]}], "]"}]}]}], ",", 
   RowBox[{"q", "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", "u"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.465006386892065*^9, 3.46500943414812*^9, 
  3.4650124727227697`*^9, 3.4650289843717833`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"equationk", "/.", "trans"}], "]"}]], "Input",
 CellChangeTimes->{{3.4650063903492327`*^9, 3.465006434499675*^9}, {
  3.465010180589292*^9, 3.465010182109317*^9}, {3.4650103001391478`*^9, 
  3.465010317051754*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", "\[Pi]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", 
       RowBox[{"h", " ", "s"}]}], ")"}], " ", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"n", ",", 
       RowBox[{"s", " ", "u"}]}], "]"}], " ", 
     RowBox[{"BesselY", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
    RowBox[{"s", " ", "u", " ", 
     RowBox[{"BesselJ", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"s", " ", "u"}]}], "]"}], " ", 
     RowBox[{"BesselY", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"BesselJ", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselY", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"BesselY", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{3.465006415408965*^9, 3.465006543484695*^9, 
  3.4650094676646442`*^9, 3.465010183700742*^9, 3.465010318031008*^9, 
  3.465012474942376*^9, 3.465028987562429*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prefnBJ", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"prefn", "/.", "trans"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.465010343639591*^9, 3.46501035094925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"e", " ", "\[Pi]", " ", 
    SuperscriptBox["u", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r", " ", "u"}]}], "]"}]}], "-", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r", " ", "u"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "n"}], "+", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{"s", " ", "u", " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r0", " ", "u"}]}], "]"}]}], "-", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r0", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r0", " ", "u"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "n"}], "+", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{"s", " ", "u", " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["n", "2"], "-", 
         RowBox[{
          SuperscriptBox["s", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["h", "2"], "+", 
            SuperscriptBox["u", "2"]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"a", " ", "\[Pi]", " ", "u", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "n"}], "+", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"BesselJ", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"a", " ", "u"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "n"}], "+", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselJ", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "s", " ", "u", " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "n"}], "+", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.465012630569562*^9, 3.465029009150031*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"manually", " ", "simplify", " ", "prefnBJ"}], "*)"}]], "Input",
 CellChangeTimes->{{3.465029071389292*^9, 3.465029085009225*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["n", "2"], "-", 
         RowBox[{
          SuperscriptBox["s", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["h", "2"], "+", 
            SuperscriptBox["u", "2"]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"a", " ", "\[Pi]", " ", "u", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "n"}], "+", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"BesselJ", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"a", " ", "u"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "n"}], "+", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselJ", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "s", " ", "u", " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "n"}], "+", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"BesselY", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.465029107799436*^9, 3.465029136832382*^9}, {
  3.465029169009283*^9, 3.465029220372314*^9}, {3.465029252240646*^9, 
  3.465029265171405*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["n", "2"], "-", 
         RowBox[{
          SuperscriptBox["s", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["h", "2"], "+", 
            SuperscriptBox["u", "2"]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"a", " ", "\[Pi]", " ", "u", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "n"}], "+", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"BesselJ", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"a", " ", "u"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "n"}], "+", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselJ", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "s", " ", "u", " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "n"}], "+", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"BesselY", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"BesselY", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.465029119415265*^9, 3.4650291379704514`*^9}, {
   3.4650291759647903`*^9, 3.46502922720218*^9}, 3.46503030515451*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"predenom1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"a", " ", "\[Pi]", " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "n"}], "+", 
                RowBox[{"h", " ", "s"}]}], ")"}], " ", 
              RowBox[{"BesselJ", "[", 
               RowBox[{"n", ",", 
                RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
             RowBox[{"s", " ", "u", " ", 
              RowBox[{"BesselJ", "[", 
               RowBox[{
                RowBox[{"1", "+", "n"}], ",", 
                RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"BesselJ", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"a", " ", "u"}]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", 
                RowBox[{"h", " ", "s"}]}], ")"}], " ", 
              RowBox[{"BesselY", "[", 
               RowBox[{"n", ",", 
                RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
             RowBox[{"s", " ", "u", " ", 
              RowBox[{"BesselY", "[", 
               RowBox[{
                RowBox[{"1", "+", "n"}], ",", 
                RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "n"}], "+", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"BesselJ", "[", 
             RowBox[{"n", ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "s", " ", "u", " ", 
               RowBox[{"BesselJ", "[", 
                RowBox[{
                 RowBox[{"1", "+", "n"}], ",", 
                 RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "n"}], "+", 
                 RowBox[{"h", " ", "s"}]}], ")"}], " ", 
               RowBox[{"BesselY", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
              RowBox[{"s", " ", "u", " ", 
               RowBox[{"BesselY", "[", 
                RowBox[{
                 RowBox[{"1", "+", "n"}], ",", 
                 RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], 
         "]"}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}]}], "+", 
   RowBox[{"-", 
    RowBox[{"Simplify", "[", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "2"], "-", 
        RowBox[{
         SuperscriptBox["s", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["h", "2"], "+", 
           SuperscriptBox["u", "2"]}], ")"}]}]}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"BesselJ", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}]}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.465029307069273*^9, 3.465029420599545*^9}, {
   3.4650295248198347`*^9, 3.465029574929974*^9}, {3.46502961179698*^9, 
   3.465029617719244*^9}, {3.4650297717793293`*^9, 3.465029797001807*^9}, {
   3.465029891392437*^9, 3.465029894324305*^9}, 3.465030055341745*^9, {
   3.46503107479919*^9, 3.465031083060627*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "4"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["n", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "+", 
        SuperscriptBox["u", "2"]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", " ", "a", " ", "\[Pi]", " ", "u", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{"n", ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
          RowBox[{"s", " ", "u", " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "n"}], "+", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselJ", "[", 
            RowBox[{"n", ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
          RowBox[{"s", " ", "u", " ", 
           RowBox[{"BesselJ", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"BesselY", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{"n", ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
          RowBox[{"s", " ", "u", " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
   "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"BesselJ", "[", 
       RowBox[{"n", ",", 
        RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"BesselY", "[", 
       RowBox[{"n", ",", 
        RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.4650293574785967`*^9, 3.465029399350439*^9}, 
   3.465029449951551*^9, {3.4650295380715637`*^9, 3.465029576921867*^9}, 
   3.465029619160747*^9, 3.4650297987152843`*^9, 3.465029895560274*^9, 
   3.465030057695209*^9, 3.465030308366173*^9, {3.465031078866832*^9, 
   3.465031084211277*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"predenom2", "=", 
  RowBox[{
   RowBox[{"predenom1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}]}], "\[Rule]", "A"}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}]}], "\[Rule]", "B"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.46502989784638*^9, 3.465029944959269*^9}, {
   3.465029986399425*^9, 3.465029989692934*^9}, {3.4650300608920803`*^9, 
   3.4650300651630783`*^9}, 3.4650302283939857`*^9, 3.4650304991736727`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "4"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["n", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "+", 
        SuperscriptBox["u", "2"]}], ")"}]}]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"2", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{"A", "+", 
      RowBox[{"\[ImaginaryI]", " ", "B"}]}], ")"}], " ", "\[Pi]", " ", "u", 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"B", " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{"A", " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"BesselY", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}]}]]}]], "Output",
 CellChangeTimes->{3.465029900450683*^9, 3.465029945693783*^9, 
  3.465029990969941*^9, 3.4650300659423933`*^9, 3.4650302297418003`*^9, 
  3.4650303103563766`*^9, 3.465030504252941*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "solB", "}"}], "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"A", " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{"B", " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}]}], "==", "0"}], ",", "B"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4650305202493477`*^9, 3.465030592223063*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"B", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"A", " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}], 
      RowBox[{"BesselJ", "[", 
       RowBox[{"n", ",", 
        RowBox[{"a", " ", "u"}]}], "]"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.4650305707222443`*^9, 3.465030592971027*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"predenom3", "=", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"predenom2", "/.", "solB"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{"A", "->", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "n"}], "+", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.465030046079398*^9, 3.4650301221345587`*^9}, 
   3.465030285039299*^9, 3.46503040206909*^9, 3.465030506833921*^9, {
   3.4650305969092207`*^9, 3.4650305981726923`*^9}, {3.465030705264842*^9, 
   3.4650307227296467`*^9}}],

Cell[BoxData[
 RowBox[{"4", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["n", "2"], "-", 
    RowBox[{
     SuperscriptBox["s", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["h", "2"], "+", 
       SuperscriptBox["u", "2"]}], ")"}]}], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"h", " ", "s"}]}], ")"}], " ", 
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
        RowBox[{"s", " ", "u", " ", 
         RowBox[{"BesselJ", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], "2"], 
     SuperscriptBox[
      RowBox[{"BesselJ", "[", 
       RowBox[{"n", ",", 
        RowBox[{"a", " ", "u"}]}], "]"}], "2"]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.4650303127639313`*^9, {3.4650303952000723`*^9, 3.465030403240107*^9}, 
   3.4650305076675158`*^9, 3.465030598959812*^9, 3.465030729000638*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"The", " ", "final", " ", "solution", " ", "is"}], "*)"}]], "Input",\

 CellChangeTimes->{{3.46503099054926*^9, 3.465031005939341*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solnBJ", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"e", " ", "\[Pi]", " ", 
     SuperscriptBox["u", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}], " ", 
        RowBox[{"BesselY", "[", 
         RowBox[{"n", ",", 
          RowBox[{"r", " ", "u"}]}], "]"}]}], "-", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}], " ", 
        RowBox[{"BesselY", "[", 
         RowBox[{"n", ",", 
          RowBox[{"r", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"r", " ", "u"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "n"}], "+", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{"n", ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
          RowBox[{"s", " ", "u", " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}], " ", 
        RowBox[{"BesselY", "[", 
         RowBox[{"n", ",", 
          RowBox[{"r0", " ", "u"}]}], "]"}]}], "-", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}], " ", 
        RowBox[{"BesselY", "[", 
         RowBox[{"n", ",", 
          RowBox[{"r0", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"r0", " ", "u"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "n"}], "+", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{"n", ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
          RowBox[{"s", " ", "u", " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
   "/", "predenom3"}]}]], "Input",
 CellChangeTimes->{{3.465030904750581*^9, 3.465030951972302*^9}, {
   3.4650310344702473`*^9, 3.465031050919426*^9}, 3.465031104031218*^9, 
   3.465031144707419*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"e", " ", "\[Pi]", " ", 
    SuperscriptBox["u", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r", " ", "u"}]}], "]"}]}], "-", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r", " ", "u"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "n"}], "+", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{"s", " ", "u", " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r0", " ", "u"}]}], "]"}]}], "-", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r0", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r0", " ", "u"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "n"}], "+", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{"s", " ", "u", " ", 
          RowBox[{"BesselY", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["n", "2"], "-", 
      RowBox[{
       SuperscriptBox["s", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["h", "2"], "+", 
         SuperscriptBox["u", "2"]}], ")"}]}], "+", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "n"}], "+", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselJ", "[", 
            RowBox[{"n", ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
          RowBox[{"s", " ", "u", " ", 
           RowBox[{"BesselJ", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], "2"]]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.465030922777128*^9, 3.465030953761644*^9}, {
   3.46503104063172*^9, 3.4650310526536703`*^9}, 3.465031104941629*^9, 
   3.465031145555581*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"In", " ", "trigonometric", " ", "form", " ", "III"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.465088358129265*^9, 3.465088360989203*^9}, {
  3.465091808899225*^9, 3.465091810029261*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expansions1", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"BesselJ", "[", 
      RowBox[{"n_", ",", "z_"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "/", 
        RowBox[{"(", 
         RowBox[{"Pi", " ", "z"}], ")"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"n", ",", "z"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"z", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"n", "/", "2"}], "+", 
              RowBox[{"1", "/", "4"}]}], ")"}], "Pi"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", "z"}], "]"}], 
         RowBox[{"Sin", "[", 
          RowBox[{"z", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"n", "/", "2"}], "+", 
              RowBox[{"1", "/", "4"}]}], ")"}], "Pi"}]}], "]"}]}]}], 
       ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"BesselY", "[", 
      RowBox[{"n_", ",", "z_"}], "]"}], "->", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "/", 
        RowBox[{"(", 
         RowBox[{"Pi", " ", "z"}], ")"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"n", ",", "z"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"z", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"n", "/", "2"}], "+", 
              RowBox[{"1", "/", "4"}]}], ")"}], "Pi"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", "z"}], "]"}], 
         RowBox[{"Cos", "[", 
          RowBox[{"z", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"n", "/", "2"}], "+", 
              RowBox[{"1", "/", "4"}]}], ")"}], "Pi"}]}], "]"}]}]}], 
       ")"}]}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.465088371723092*^9, 3.4650885608942413`*^9}, 
   3.465090956679463*^9, {3.465091079706538*^9, 3.465091086839293*^9}, {
   3.465091418976742*^9, 3.465091504599207*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"BesselJ", "[", 
     RowBox[{"n_", ",", "z_"}], "]"}], "\[Rule]", 
    RowBox[{
     SqrtBox[
      FractionBox["2", "\[Pi]"]], " ", 
     SqrtBox[
      FractionBox["1", "z"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "4"], "+", 
             FractionBox["n", "2"]}], ")"}], " ", "\[Pi]"}], "-", "z"}], 
         "]"}], " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", "z"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", "z"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "4"], "+", 
             FractionBox["n", "2"]}], ")"}], " ", "\[Pi]"}], "-", "z"}], 
         "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"BesselY", "[", 
     RowBox[{"n_", ",", "z_"}], "]"}], "\[Rule]", 
    RowBox[{
     SqrtBox[
      FractionBox["2", "\[Pi]"]], " ", 
     SqrtBox[
      FractionBox["1", "z"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "4"], "+", 
             FractionBox["n", "2"]}], ")"}], " ", "\[Pi]"}], "-", "z"}], 
         "]"}], " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", "z"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"n", ",", "z"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "4"], "+", 
             FractionBox["n", "2"]}], ")"}], " ", "\[Pi]"}], "-", "z"}], 
         "]"}]}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.465088562082041*^9, 3.465090958202948*^9, 3.465091087697847*^9, 
   3.4650914319456987`*^9, {3.465091479186461*^9, 3.465091505453024*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expansions2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TrigExpand", "[", 
     RowBox[{"expansions1", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "4"], "+", 
            FractionBox["n", "2"]}], ")"}], " ", "\[Pi]"}], "-", "z"}], 
        "\[Rule]", 
        RowBox[{
         RowBox[{"Pi", "/", "4"}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"Pi", "/", "2"}]}], "-", "z"}]}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "2"], "]"}], " ", "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "2"], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}]}]}]}], "}"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.465090603579298*^9, 3.46509066562919*^9}, {
  3.465090695979219*^9, 3.465090747829767*^9}, {3.465090779179268*^9, 
  3.465090867481102*^9}, {3.4650909604063053`*^9, 3.465090969003915*^9}, {
  3.465091487508622*^9, 3.465091544439323*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"BesselJ", "[", 
     RowBox[{"n_", ",", "z_"}], "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "n"], " ", 
      SqrtBox[
       FractionBox["1", "z"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"n", ",", "z"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "z", "]"}], "-", 
           RowBox[{"Sin", "[", "z", "]"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", "z"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "z", "]"}], "+", 
           RowBox[{"Sin", "[", "z", "]"}]}], ")"}]}]}], ")"}]}], 
     SqrtBox["\[Pi]"]]}], ",", 
   RowBox[{
    RowBox[{"BesselY", "[", 
     RowBox[{"n_", ",", "z_"}], "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "n"], " ", 
      SqrtBox[
       FractionBox["1", "z"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", "z"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "z", "]"}], "-", 
           RowBox[{"Sin", "[", "z", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"n", ",", "z"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "z", "]"}], "+", 
           RowBox[{"Sin", "[", "z", "]"}]}], ")"}]}]}], ")"}]}], 
     SqrtBox["\[Pi]"]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4650906445634537`*^9, 3.4650906665187197`*^9}, {
   3.465090737909219*^9, 3.465090749019158*^9}, {3.465090780883863*^9, 
   3.465090868287961*^9}, {3.4650909612970743`*^9, 3.46509097059534*^9}, 
   3.465091091402684*^9, 3.465091546762648*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"equationk", "/.", "trans"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", "\[Pi]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", 
       RowBox[{"h", " ", "s"}]}], ")"}], " ", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"n", ",", 
       RowBox[{"s", " ", "u"}]}], "]"}], " ", 
     RowBox[{"BesselY", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
    RowBox[{"s", " ", "u", " ", 
     RowBox[{"BesselJ", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"s", " ", "u"}]}], "]"}], " ", 
     RowBox[{"BesselY", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"BesselJ", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselY", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"BesselY", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{3.465091554662119*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trigtmp1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"equationk", "/.", "trans"}], "]"}], "/.", "expansions2"}], "//",
    "TrigFactor"}]}]], "Input",
 CellChangeTimes->{{3.4650885734891663`*^9, 3.465088614523862*^9}, {
   3.465088666315487*^9, 3.4650886708393717`*^9}, {3.465088710840626*^9, 
   3.465088747269278*^9}, 3.465088788813159*^9, {3.4650888805192347`*^9, 
   3.465088883389304*^9}, {3.465089011268907*^9, 3.4650890550589323`*^9}, {
   3.4650893939892178`*^9, 3.465089445432324*^9}, {3.465089482749651*^9, 
   3.465089523639282*^9}, {3.465089596609779*^9, 3.465089624213007*^9}, {
   3.465089667979198*^9, 3.4650897274292517`*^9}, {3.4650898290493298`*^9, 
   3.465089839222331*^9}, {3.465091026289345*^9, 3.4650910322414207`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], 
    RowBox[{"2", " ", "n"}]]}], " ", 
  SqrtBox[
   FractionBox["1", 
    RowBox[{"a", " ", "u"}]]], " ", 
  SqrtBox[
   FractionBox["1", 
    RowBox[{"s", " ", "u"}]]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"a", " ", "u"}], "-", 
       RowBox[{"s", " ", "u"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}], " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
       RowBox[{"h", " ", "s", " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}], " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}], " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
       RowBox[{"n", " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"h", " ", "s", " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], " ", 
        RowBox[{"Q", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
       RowBox[{"h", " ", "s", " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], " ", 
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"n", " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
       RowBox[{"h", " ", "s", " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], " ", 
        RowBox[{"Q", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", " ", "u"}], "-", 
       RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.4650886038464193`*^9, 3.4650886161414127`*^9}, 
   3.465088672451178*^9, {3.4650887234767103`*^9, 3.4650887482509823`*^9}, 
   3.465088789921546*^9, 3.465088884232491*^9, {3.4650890176727448`*^9, 
   3.465089056081636*^9}, {3.465089411500607*^9, 3.46508944680096*^9}, {
   3.465089496258143*^9, 3.465089524445107*^9}, 3.465089597551162*^9, 
   3.465089630437676*^9, {3.465089672352303*^9, 3.465089688621502*^9}, {
   3.465089720809757*^9, 3.4650897283114023`*^9}, {3.465089835606944*^9, 
   3.465089840769404*^9}, {3.46509102748412*^9, 3.465091033244762*^9}, 
   3.465091104386622*^9, 3.465091565924553*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"transcossin", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"a_", " ", 
      RowBox[{"Cos", "[", "z_", "]"}]}], "+", 
     RowBox[{"b_", " ", 
      RowBox[{"Sin", "[", "z_", "]"}]}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"b", "^", "2"}], "/", 
        RowBox[{"a", "^", "2"}]}]}], "]"}], " ", "a", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"z", "-", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"b", "/", "a"}], "]"}]}], "]"}]}]}], "}"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"falpha1", "=", 
  RowBox[{
   RowBox[{"trigtmp1", "/.", "transcossin"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.465089844899251*^9, 3.4650898527393293`*^9}, {
   3.465089898929328*^9, 3.4650899182291927`*^9}, {3.465090220969277*^9, 
   3.465090240229278*^9}, 3.465091124184308*^9, {3.465091162933647*^9, 
   3.4650911655893517`*^9}, {3.465104706279297*^9, 3.465104714139223*^9}, 
   3.465104891041623*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], 
    RowBox[{"2", " ", "n"}]]}], " ", 
  SqrtBox[
   FractionBox["1", 
    RowBox[{"a", " ", "u"}]]], " ", 
  SqrtBox[
   FractionBox["1", 
    RowBox[{"s", " ", "u"}]]], " ", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "-", "s"}], ")"}], " ", "u"}], "-", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"P", "[", 
             RowBox[{"n", ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
           RowBox[{"s", " ", "u", " ", 
            RowBox[{"P", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"Q", "[", 
             RowBox[{"n", ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
           RowBox[{"s", " ", "u", " ", 
            RowBox[{"Q", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", 
           RowBox[{"h", " ", "s"}]}], ")"}], " ", 
         RowBox[{"P", "[", 
          RowBox[{"n", ",", 
           RowBox[{"s", " ", "u"}]}], "]"}], " ", 
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
        RowBox[{"s", " ", "u", " ", 
         RowBox[{"P", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"s", " ", "u"}]}], "]"}], " ", 
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"Q", "[", 
             RowBox[{"n", ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
           RowBox[{"s", " ", "u", " ", 
            RowBox[{"Q", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
     "]"}]}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", 
       RowBox[{"h", " ", "s"}]}], ")"}], " ", 
     RowBox[{"P", "[", 
      RowBox[{"n", ",", 
       RowBox[{"s", " ", "u"}]}], "]"}], " ", 
     RowBox[{"Q", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
    RowBox[{"s", " ", "u", " ", 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", 
       RowBox[{"s", " ", "u"}]}], "]"}], " ", 
     RowBox[{"Q", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"Q", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
  RowBox[{"\[Sqrt]", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"P", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"P", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"Q", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"Q", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"Q", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], "2"], 
      "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"P", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}], " ", 
          RowBox[{"Q", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{"s", " ", "u", " ", 
          RowBox[{"P", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"s", " ", "u"}]}], "]"}], " ", 
          RowBox[{"Q", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"Q", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"Q", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], 
       "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.4650898537337503`*^9, {3.4650899087930317`*^9, 3.465089922193611*^9}, 
   3.4650902412915373`*^9, 3.4650911255338573`*^9, 3.465091166503313*^9, 
   3.465091575709957*^9, {3.465104711126713*^9, 3.465104715222522*^9}, 
   3.465104892043041*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"falpha1", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"P", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{"s", " ", "u", " ", 
          RowBox[{"P", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}]}], "\[Rule]", "C"}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", 
           RowBox[{"h", " ", "s"}]}], ")"}], " ", 
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", 
           RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
        RowBox[{"s", " ", "u", " ", 
         RowBox[{"Q", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"s", " ", "u"}]}], "]"}]}]}], "\[Rule]", "D"}], "}"}]}], 
    "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"P", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"P", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}]}], "\[Rule]", "C"}], "}"}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"h", " ", "s"}]}], ")"}], " ", 
      RowBox[{"Q", "[", 
       RowBox[{"n", ",", 
        RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
     RowBox[{"s", " ", "u", " ", 
      RowBox[{"Q", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", 
        RowBox[{"s", " ", "u"}]}], "]"}]}]}], "\[Rule]", "D"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.46510500786924*^9, 3.465105138643696*^9}, 
   3.46510521645366*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], 
    RowBox[{"2", " ", "n"}]]}], " ", 
  SqrtBox[
   FractionBox["1", 
    RowBox[{"a", " ", "u"}]]], " ", 
  SqrtBox[
   FractionBox["1", 
    RowBox[{"s", " ", "u"}]]], " ", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "-", "s"}], ")"}], " ", "u"}], "-", 
    RowBox[{"ArcTan", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"C", " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"D", " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "D"}], " ", 
        RowBox[{"P", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"C", " ", 
        RowBox[{"Q", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}]}]}]], "]"}]}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "D"}], " ", 
     RowBox[{"P", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
    RowBox[{"C", " ", 
     RowBox[{"Q", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
  SqrtBox[
   RowBox[{"1", "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", 
         RowBox[{"P", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
        RowBox[{"D", " ", 
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}], "2"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", " ", 
         RowBox[{"P", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
        RowBox[{"C", " ", 
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}], "2"]]}]]}]], "Output",\

 CellChangeTimes->{{3.465105010296665*^9, 3.465105139553565*^9}, 
   3.4651052176231422`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "-", "s"}], ")"}], " ", "u"}], "-", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"P", "[", 
             RowBox[{"n", ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
           RowBox[{"s", " ", "u", " ", 
            RowBox[{"P", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"Q", "[", 
             RowBox[{"n", ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
           RowBox[{"s", " ", "u", " ", 
            RowBox[{"Q", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", 
           RowBox[{"h", " ", "s"}]}], ")"}], " ", 
         RowBox[{"P", "[", 
          RowBox[{"n", ",", 
           RowBox[{"s", " ", "u"}]}], "]"}], " ", 
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
        RowBox[{"s", " ", "u", " ", 
         RowBox[{"P", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"s", " ", "u"}]}], "]"}], " ", 
         RowBox[{"Q", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"Q", "[", 
             RowBox[{"n", ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
           RowBox[{"s", " ", "u", " ", 
            RowBox[{"Q", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
     "]"}]}], ")"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.465091670574421*^9, 3.4650916845892887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", "-", "s"}], ")"}], " ", "u"}], "-", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"P", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{"s", " ", "u", " ", 
          RowBox[{"P", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"Q", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{"s", " ", "u", " ", 
          RowBox[{"Q", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"P", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}], " ", 
       RowBox[{"Q", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"P", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}], " ", 
       RowBox[{"Q", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"Q", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
         RowBox[{"s", " ", "u", " ", 
          RowBox[{"Q", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
   "]"}]}]], "Output",
 CellChangeTimes->{
  3.4650916276445923`*^9, {3.465091675324911*^9, 3.465091685593363*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "calculate", " ", "survival", " ", "rate", " ", "and", " ", "theta"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.465091887509831*^9, 3.465091900539297*^9}, {
  3.465092921749217*^9, 3.465092926969285*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"n_", ",", "r_", ",", "u_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}], " ", "-", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}]}], " ", ")"}], 
    RowBox[{"BesselY", "[", 
     RowBox[{"n", ",", 
      RowBox[{"r", " ", "u"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"BesselJ", "[", 
     RowBox[{"n", ",", 
      RowBox[{"r", " ", "u"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "n"}], "+", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.465091903300673*^9, 3.465091905789207*^9}, {
  3.4650920737092543`*^9, 3.465092102879538*^9}, {3.4650921431434317`*^9, 
  3.465092144459614*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"h", " ", "s"}]}], ")"}], " ", 
      RowBox[{"BesselJ", "[", 
       RowBox[{"n", ",", 
        RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
     RowBox[{"s", " ", "u", " ", 
      RowBox[{"BesselJ", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", 
        RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"BesselY", "[", 
    RowBox[{"n", ",", 
     RowBox[{"r", " ", "u"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"BesselJ", "[", 
    RowBox[{"n", ",", 
     RowBox[{"r", " ", "u"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "n"}], "+", 
        RowBox[{"h", " ", "s"}]}], ")"}], " ", 
      RowBox[{"BesselY", "[", 
       RowBox[{"n", ",", 
        RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
     RowBox[{"s", " ", "u", " ", 
      RowBox[{"BesselY", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", 
        RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.465091906516164*^9, {3.465092075193077*^9, 3.465092103650332*^9}, 
   3.4650921450518293`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"denomf", "[", 
   RowBox[{"n_", ",", "u_"}], "]"}], "=", 
  RowBox[{
   SuperscriptBox["n", "2"], "-", 
   RowBox[{
    SuperscriptBox["s", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "2"], "+", 
      SuperscriptBox["u", "2"]}], ")"}]}], "+", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], "2"], 
    SuperscriptBox[
     RowBox[{"BesselJ", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}], "2"]]}]}]], "Input",
 CellChangeTimes->{{3.46509212972928*^9, 3.465092200062438*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["n", "2"], "-", 
  RowBox[{
   SuperscriptBox["s", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["h", "2"], "+", 
     SuperscriptBox["u", "2"]}], ")"}]}], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "n"}], "+", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], "2"], 
   SuperscriptBox[
    RowBox[{"BesselJ", "[", 
     RowBox[{"n", ",", 
      RowBox[{"a", " ", "u"}]}], "]"}], "2"]]}]], "Output",
 CellChangeTimes->{{3.465092153129221*^9, 3.465092201203692*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"denomf", "[", 
   RowBox[{"m", ",", "u"}], "]"}], "//", "TeXForm"}]], "Input"],

Cell["\<\
\\frac{((h s-m) J_m(s u)+s u J_{m+1}(s u)){}^2}{J_m(a u){}^2}-s^2 \
\\left(h^2+u^2\\right)+m^2\
\>", "Output",
 CellChangeTimes->{3.465099985944092*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"solnBJ", "\[Equal]", 
    RowBox[{"e", " ", "Pi", " ", 
     RowBox[{
      RowBox[{"u", "^", "2"}], " ", "/", "4"}], " ", 
     RowBox[{"f", "[", 
      RowBox[{"n", ",", "r", ",", "u"}], "]"}], 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"n", ",", "r0", ",", "u"}], "]"}], "/", 
      RowBox[{"denomf", "[", 
       RowBox[{"n", ",", "u"}], "]"}]}]}]}], ")"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.4650922062923*^9, 3.465092273883403*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.46509221145048*^9, {3.465092244344838*^9, 3.465092274919239*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"equationk", "/.", "trans"}], "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "Pi"}], "/", "2"}], 
     RowBox[{"f", "[", 
      RowBox[{"n", ",", "a", ",", "u"}], "]"}]}]}], ")"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.465092616739191*^9, 3.465092658329275*^9}, {
  3.465092692367969*^9, 3.465092696139485*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.465092643343665*^9, 3.465092659823202*^9}, 
   3.465092697154419*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bess2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"BesselJ", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ",", "z_"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"n", " ", "/", "z"}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], "-", 
      RowBox[{"BesselJ", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", "z"}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"BesselY", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ",", "z_"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"n", " ", "/", "z"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], "-", 
      RowBox[{"BesselY", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", "z"}], "]"}]}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.465093142536635*^9, 3.465093255759307*^9}, {
  3.4650933165809393`*^9, 3.4650933208516893`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"BesselJ", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ",", "z_"}], "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "n", " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], "z"], "-", 
     RowBox[{"BesselJ", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", "z"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"BesselY", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ",", "z_"}], "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "n", " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", "z"}], "]"}]}], "z"], "-", 
     RowBox[{"BesselY", "[", 
      RowBox[{
       RowBox[{"1", "+", "n"}], ",", "z"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.4650933235340443`*^9, 3.465093367941874*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kDf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"k", " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"n", ",", "r", ",", "u"}], "]"}], ",", "r"}], "]"}]}], "/.",
         "bess2"}], "/.", 
       RowBox[{"{", 
        RowBox[{"r", "\[Rule]", "a"}], "}"}]}], "//", "Expand"}], "]"}], "/.", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", 
           RowBox[{"h", " ", "s"}]}], ")"}], " ", 
         RowBox[{"BesselY", "[", 
          RowBox[{"n", ",", 
           RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
        RowBox[{"s", " ", "u", " ", 
         RowBox[{"BesselY", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], "->", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselJ", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
         RowBox[{"s", " ", "u", " ", 
          RowBox[{"BesselJ", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], 
       RowBox[{
        RowBox[{"BesselY", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], "/", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}]}]}]}], "}"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.4650929735402527`*^9, 3.465093021299053*^9}, {
  3.465093111439534*^9, 3.46509312034103*^9}, {3.465093370189251*^9, 
  3.465093390449318*^9}, {3.465093426251628*^9, 3.465093447169211*^9}, {
  3.465093520299279*^9, 3.465093690029235*^9}, {3.46509375379419*^9, 
  3.4650937682092876`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "k", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "n"}], "+", 
         RowBox[{"h", " ", "s"}]}], ")"}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{"s", " ", "u", " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}], 
   RowBox[{"a", " ", "\[Pi]", " ", 
    RowBox[{"BesselJ", "[", 
     RowBox[{"n", ",", 
      RowBox[{"a", " ", "u"}]}], "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.465093607914454*^9, 3.4650936916417294`*^9}, {
  3.465093755282956*^9, 3.4650937690298347`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"k", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"n", ",", "r", ",", "u"}], "]"}], ",", "r"}], "]"}]}], "/.", 
     "bess2"}], "/.", 
    RowBox[{"{", 
     RowBox[{"r", "\[Rule]", "a"}], "}"}]}], "//", "Expand"}], "]"}]], "Input",\

 CellChangeTimes->{{3.465104038607863*^9, 3.465104058699225*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "a"], 
  RowBox[{"k", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"h", " ", "s"}]}], ")"}], " ", 
      RowBox[{"BesselJ", "[", 
       RowBox[{"n", ",", 
        RowBox[{"s", " ", "u"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"n", " ", 
         RowBox[{"BesselY", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
        RowBox[{"a", " ", "u", " ", 
         RowBox[{"BesselY", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{"s", " ", "u", " ", 
      RowBox[{"BesselJ", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", 
        RowBox[{"s", " ", "u"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "n"}], " ", 
         RowBox[{"BesselY", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
        RowBox[{"a", " ", "u", " ", 
         RowBox[{"BesselY", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"n", " ", 
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}], "-", 
        RowBox[{"a", " ", "u", " ", 
         RowBox[{"BesselJ", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"a", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", 
           RowBox[{"h", " ", "s"}]}], ")"}], " ", 
         RowBox[{"BesselY", "[", 
          RowBox[{"n", ",", 
           RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
        RowBox[{"s", " ", "u", " ", 
         RowBox[{"BesselY", "[", 
          RowBox[{
           RowBox[{"1", "+", "n"}], ",", 
           RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.46510403982355*^9, 3.465104059675008*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"e", " ", "Pi", " ", 
   RowBox[{
    RowBox[{"u", "^", "2"}], " ", "/", "4"}], " ", "kDf", " ", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"n", ",", "r0", ",", "u"}], "]"}], "/.", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "n"}], "+", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{"n", ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
          RowBox[{"s", " ", "u", " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], "->", " ", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"h", " ", "s"}]}], ")"}], " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{"n", ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
            RowBox[{"s", " ", "u", " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{
               RowBox[{"1", "+", "n"}], ",", 
               RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"BesselY", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}], "/", 
          RowBox[{"BesselJ", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", " ", "u"}]}], "]"}]}]}]}], "}"}]}], "]"}], "/", 
    RowBox[{"denomf", "[", 
     RowBox[{"n", ",", "u"}], "]"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.465093964739258*^9, 3.4650940650297813`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"e", " ", "k", " ", 
    SuperscriptBox["u", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"r0", " ", "u"}]}], "]"}]}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"a", " ", "u"}]}], "]"}], " ", 
       RowBox[{"BesselY", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r0", " ", "u"}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"2", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["n", "2"], "-", 
         RowBox[{
          SuperscriptBox["s", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["h", "2"], "+", 
            SuperscriptBox["u", "2"]}], ")"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"a", " ", "u"}]}], "]"}], "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", 
            RowBox[{"h", " ", "s"}]}], ")"}], " ", 
          RowBox[{"BesselJ", "[", 
           RowBox[{"n", ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
         RowBox[{"s", " ", "u", " ", 
          RowBox[{"BesselJ", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], "2"]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.465093978002461*^9, 3.465094003922991*^9}, {
  3.465094059325181*^9, 3.4650940659953413`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"e", " ", "Pi", " ", 
   RowBox[{
    RowBox[{"u", "^", "2"}], " ", "/", " ", "4"}], " ", "kDf", " ", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"n", ",", "r0", ",", "u"}], "]"}], "/", 
    RowBox[{"denomf", "[", 
     RowBox[{"n", ",", "u"}], "]"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.465093779394326*^9, 3.465093813789301*^9}, 
   3.4650938676141987`*^9, {3.465093906349242*^9, 3.465093920219576*^9}, {
   3.465093961220543*^9, 3.465093962752543*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"e", " ", "k", " ", 
     SuperscriptBox["u", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", 
          RowBox[{"h", " ", "s"}]}], ")"}], " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{"s", " ", "u", " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{"1", "+", "n"}], ",", 
          RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselJ", "[", 
            RowBox[{"n", ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}], "-", 
          RowBox[{"s", " ", "u", " ", 
           RowBox[{"BesselJ", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"BesselY", "[", 
         RowBox[{"n", ",", 
          RowBox[{"r0", " ", "u"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"r0", " ", "u"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "n"}], "+", 
             RowBox[{"h", " ", "s"}]}], ")"}], " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{"n", ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
          RowBox[{"s", " ", "u", " ", 
           RowBox[{"BesselY", "[", 
            RowBox[{
             RowBox[{"1", "+", "n"}], ",", 
             RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
   "/", 
   RowBox[{"(", 
    RowBox[{"2", " ", "a", " ", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", " ", "u"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["n", "2"], "-", 
       RowBox[{
        SuperscriptBox["s", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["h", "2"], "+", 
          SuperscriptBox["u", "2"]}], ")"}]}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "n"}], "+", 
              RowBox[{"h", " ", "s"}]}], ")"}], " ", 
            RowBox[{"BesselJ", "[", 
             RowBox[{"n", ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}], "+", 
           RowBox[{"s", " ", "u", " ", 
            RowBox[{"BesselJ", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"s", " ", "u"}]}], "]"}]}]}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"a", " ", "u"}]}], "]"}], "2"]]}], ")"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.465093808595264*^9, 3.465093814820404*^9}, 
   3.465093875661134*^9, {3.4650939099486227`*^9, 3.465093921180993*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"m", " ", "p"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", 
       RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"m", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.465100388254388*^9, 3.465100440589329*^9}, {
  3.465106029666601*^9, 3.4651060348013067`*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", "\[Pi]"}]], "Output",
 CellChangeTimes->{{3.465100404944278*^9, 3.465100441810025*^9}, {
  3.4651060309094353`*^9, 3.465106035660798*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"m", " ", "p"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "p1"}], "}"}]}], "]"}], ",", 
   RowBox[{"m", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.465108503180661*^9, 3.465108543735868*^9}}],

Cell[BoxData["p1"], "Output",
 CellChangeTimes->{3.4651085450616417`*^9}]
}, Open  ]]
},
WindowSize->{834, 1520},
WindowMargins->{{744, Automatic}, {Automatic, 25}},
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{594.3000000000001, 840.51},
"PostScriptOutputFile"->"/home/kaizu/Pair2D.nb.pdf"},
FrontEndVersion->"7.0 for Linux x86 (64-bit) (2009\:5e744\:670823\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 253, 5, 32, "Input"],
Cell[801, 27, 409, 13, 32, "Input"],
Cell[CellGroupData[{
Cell[1235, 44, 524, 15, 32, "Input"],
Cell[1762, 61, 989, 16, 24, "Message"]
}, Open  ]],
Cell[2766, 80, 570, 18, 32, "Input"],
Cell[CellGroupData[{
Cell[3361, 102, 970, 30, 55, "Input"],
Cell[4334, 134, 918, 30, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5289, 169, 629, 16, 32, "Input"],
Cell[5921, 187, 1350, 39, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7308, 231, 843, 25, 55, "Input"],
Cell[8154, 258, 5942, 168, 192, "Output"]
}, Open  ]],
Cell[14111, 429, 279, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[14415, 439, 731, 20, 55, "Input"],
Cell[15149, 461, 4658, 133, 132, "Output"]
}, Open  ]],
Cell[19822, 597, 282, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[20129, 607, 1521, 45, 77, "Input"],
Cell[21653, 654, 1323, 42, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23013, 701, 3181, 90, 143, "Input"],
Cell[26197, 793, 2636, 85, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28870, 883, 362, 9, 32, "Input"],
Cell[29235, 894, 4484, 132, 152, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33756, 1031, 162, 3, 32, "Input"],
Cell[33921, 1036, 96, 1, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34054, 1042, 380, 10, 32, "Input"],
Cell[34437, 1054, 1719, 50, 72, "Output"]
}, Open  ]],
Cell[36171, 1107, 264, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[36460, 1117, 278, 6, 32, "Input"],
Cell[36741, 1125, 3369, 102, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40147, 1232, 401, 10, 32, "Input"],
Cell[40551, 1244, 4077, 122, 180, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44665, 1371, 323, 9, 32, "Input"],
Cell[44991, 1382, 1001, 16, 45, "Message"],
Cell[45995, 1400, 3144, 96, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49176, 1501, 446, 10, 32, "Input"],
Cell[49625, 1513, 5771, 166, 186, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55433, 1684, 1212, 38, 55, "Input"],
Cell[56648, 1724, 1318, 38, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58003, 1767, 265, 5, 32, "Input"],
Cell[58271, 1774, 1487, 46, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59795, 1825, 188, 4, 32, "Input"],
Cell[59986, 1831, 6497, 192, 206, "Output"]
}, Open  ]],
Cell[66498, 2026, 170, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[66693, 2033, 3899, 112, 143, "Input"],
Cell[70595, 2147, 3876, 111, 120, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74508, 2263, 4673, 129, 231, "Input"],
Cell[79184, 2394, 3461, 103, 116, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82682, 2502, 1293, 38, 55, "Input"],
Cell[83978, 2542, 1355, 43, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85370, 2590, 505, 16, 32, "Input"],
Cell[85878, 2608, 435, 13, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86350, 2626, 879, 24, 55, "Input"],
Cell[87232, 2652, 1118, 34, 53, "Output"]
}, Open  ]],
Cell[88365, 2689, 175, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[88565, 2697, 2995, 87, 121, "Input"],
Cell[91563, 2786, 3894, 119, 153, "Output"]
}, Open  ]],
Cell[95472, 2908, 230, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[95727, 2917, 2201, 68, 121, "Input"],
Cell[97931, 2987, 2096, 69, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100064, 3061, 1305, 38, 119, "Input"],
Cell[101372, 3101, 1972, 60, 157, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103381, 3166, 97, 2, 32, "Input"],
Cell[103481, 3170, 1347, 44, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104865, 3219, 796, 14, 32, "Input"],
Cell[105664, 3235, 4387, 125, 141, "Output"]
}, Open  ]],
Cell[110066, 3363, 571, 18, 32, "Input"],
Cell[CellGroupData[{
Cell[110662, 3385, 444, 8, 32, "Input"],
Cell[111109, 3395, 7293, 223, 229, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118439, 3623, 2112, 69, 77, "Input"],
Cell[120554, 3694, 2200, 77, 120, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122791, 3776, 2885, 86, 143, "Input"],
Cell[125679, 3864, 2688, 85, 72, "Output"]
}, Open  ]],
Cell[128382, 3952, 249, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[128656, 3962, 1417, 44, 55, "Input"],
Cell[130076, 4008, 1239, 41, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131352, 4054, 1022, 33, 59, "Input"],
Cell[132377, 4089, 914, 30, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133328, 4124, 113, 3, 32, "Input"],
Cell[133444, 4129, 162, 4, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133643, 4138, 522, 15, 32, "Input"],
Cell[134168, 4155, 121, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134326, 4162, 442, 13, 32, "Input"],
Cell[134771, 4177, 123, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134931, 4184, 1023, 31, 55, "Input"],
Cell[135957, 4217, 917, 29, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136911, 4251, 2042, 59, 99, "Input"],
Cell[138956, 4312, 799, 24, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139792, 4341, 436, 14, 32, "Input"],
Cell[140231, 4357, 2199, 68, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142467, 4430, 1843, 52, 121, "Input"],
Cell[144313, 4484, 2337, 73, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146687, 4562, 514, 12, 32, "Input"],
Cell[147204, 4576, 3253, 98, 133, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150494, 4679, 442, 12, 32, "Input"],
Cell[150939, 4693, 171, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151147, 4701, 363, 10, 32, "Input"],
Cell[151513, 4713, 73, 1, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
